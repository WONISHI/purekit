# @purekit/watermark

ä¸€æ¬¾è½»é‡çº§ã€é«˜æ€§èƒ½ã€æ”¯æŒå¤æ‚å›¾æ–‡å¸ƒå±€çš„å‰ç«¯æ°´å° SDKã€‚æ”¯æŒé˜²ç¯¡æ”¹ç›‘æ§ã€å¤šè¡Œæ–‡æœ¬ã€å›¾ç‰‡æ°´å°åŠçµæ´»çš„ Flex å¸ƒå±€ç­–ç•¥ã€‚

## ğŸ“¦ å®‰è£… (Installation)

### npm

```shell
  npm install @purekit/watermark
```

### pnpm

```shell
  pnpm add @purekit/watermark
```

### yarn

```shell
yarn add @purekit/watermark
```

# ğŸš€å¿«é€Ÿå¼€å§‹ (Quick Start)

1.åŸºç¡€ç”¨æ³•
æ”¯æŒç›´æ¥ä¼ å…¥å­—ç¬¦ä¸²æˆ–æ•°ç»„ï¼ˆè‡ªåŠ¨æ¢è¡Œï¼‰ã€‚

```typescript
import Watermark from '@purekit/watermark';

// å•è¡Œæ–‡æœ¬
Watermark.apply("å†…éƒ¨ç»å¯†èµ„æ–™");

// å¤šè¡Œæ–‡æœ¬ï¼ˆè‡ªåŠ¨å‚ç›´å±…ä¸­æ’åˆ—ï¼‰
Watermark.apply(["ç»å¯†æ–‡ä»¶", "ä¸¥ç¦å¤–ä¼ ", "2023-10-01"]);
```

2. è¿›é˜¶é…ç½®
é€šè¿‡é…ç½®å¯¹è±¡æ§åˆ¶æ ·å¼ã€æ—‹è½¬å’Œé—´è·ã€‚

```js
Watermark.apply({
   content: "User: 10086",
   rotate: -25,
   fontColor: "rgba(200, 0, 0, 0.15)",
   fontSize: 20,
   zIndex: 9999
});
```

3. ğŸ”¥ å¤æ‚å›¾æ–‡å¸ƒå±€ (æ ¸å¿ƒç‰¹æ€§)
æ”¯æŒç±»ä¼¼ Flexbox çš„å¸ƒå±€ç³»ç»Ÿï¼Œå¯æ— é™åµŒå¥—å®ç°å›¾æ–‡æ··æ’ã€‚

```js
Watermark.apply({
  layout: 'repeat',
  gap: [40, 40], // ç“¦ç‰‡é—´è·
  content: {
    type: 'group',
    layout: 'row', // æ°´å¹³æ’åˆ—ï¼šå·¦å›¾å³æ–‡
    gap: 15,       // å†…å®¹é—´è·
    items: [
      // å·¦ä¾§å›¾ç‰‡
      {
        type: 'image',
        image: 'https://example.com/logo.png',
        width: 30,
        height: 30
      },
      // å³ä¾§å‚ç›´æ–‡å­—ç»„
      {
        type: 'group',
        layout: 'column', // å‚ç›´æ’åˆ—
        gap: 5,
        items: [
          { type: 'text', text: 'å†…éƒ¨èµ„æ–™', fontSize: 16, fontWeight: 'bold' },
          { type: 'text', text: 'UID: 9527', fontSize: 12, fontColor: '#666' }
        ]
      }
    ]
  }
});
```

ğŸ“š API æ–‡æ¡£
å…¨å±€é…ç½® (WatermarkOptions)

| å±æ€§ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|--------|------|
| content | `string \| any[] \| object` | â€” | æ°´å°å†…å®¹ï¼Œæ”¯æŒå­—ç¬¦ä¸²ã€æ•°ç»„æˆ–å®Œæ•´é…ç½®å¯¹è±¡ã€‚ |
| el | `string \| HTMLElement` | `document.body` | æ°´å°æŒ‚è½½çš„å®¹å™¨ï¼Œæ”¯æŒ CSS é€‰æ‹©å™¨æˆ– DOM å…ƒç´ ã€‚ |
| width | `number` | `auto` | å•ä¸ªæ°´å°ç“¦ç‰‡çš„å®½åº¦ã€‚ |
| height | `number` | `auto` | å•ä¸ªæ°´å°ç“¦ç‰‡çš„é«˜åº¦ã€‚ |
| rotate | `number` | `-20` | æ°´å°æ—‹è½¬è§’åº¦ï¼ˆå•ä½ï¼šåº¦ï¼‰ã€‚ |
| gap | `[number, number]` | `[100, 100]` | æ°´å°ç“¦ç‰‡åœ¨ X / Y æ–¹å‘çš„é—´è·ã€‚ |
| offset | `[number, number]` | `[20, 20]` | æ°´å°æ•´ä½“ç›¸å¯¹äºå®¹å™¨å·¦ä¸Šè§’çš„åç§»é‡ã€‚ |
| layout | `'repeat' \| 'center' \| 'rb'` | `'repeat'` | å¸ƒå±€æ¨¡å¼ï¼š`repeat` å¹³é“ºï¼›`center` å±…ä¸­ï¼›`rb` å³ä¸‹è§’ã€‚ |
| zIndex | `number` | `9999` | æ°´å°å±‚ DOM çš„å±‚çº§ï¼ˆz-indexï¼‰ã€‚ |
| monitor | `boolean` | `true` | æ˜¯å¦å¼€å¯é˜²ç¯¡æ”¹ç›‘æ§ï¼ˆ`MutationObserver`ï¼‰ã€‚ |
| fontColor | `string` | `'rgba(0,0,0,0.15)'` | å…¨å±€é»˜è®¤å­—ä½“é¢œè‰²ã€‚ |
| fontSize | `number` | `16` | å…¨å±€é»˜è®¤å­—ä½“å¤§å°ï¼ˆpxï¼‰ã€‚ |

**å†…å®¹èŠ‚ç‚¹ç»“æ„ (Content Node)**

å½“ content ä¸ºå¯¹è±¡æ—¶ï¼Œæ”¯æŒä»¥ä¸‹ä¸‰ç§ç±»å‹èŠ‚ç‚¹ï¼š

1. æ–‡æœ¬èŠ‚ç‚¹ (type: 'text')

| å±æ€§ | è¯´æ˜ |
|------|------|
| text | æ–‡æœ¬å†…å®¹ï¼ˆæ”¯æŒ `\n` æˆ– `<br>` æ¢è¡Œï¼Œæ¢è¡Œåè‡ªåŠ¨è½¬ä¸º Column Groupï¼‰ã€‚ |
| fontSize | å­—ä½“å¤§å°ã€‚ |
| fontColor | å­—ä½“é¢œè‰²ã€‚ |
| fontWeight | å­—é‡ï¼ˆ`bold` / `normal`ï¼‰ã€‚ |

2. å›¾ç‰‡èŠ‚ç‚¹ (type: 'image')

| å±æ€§ | è¯´æ˜ |
|------|------|
| image | å›¾ç‰‡ URL æˆ– Base64ã€‚ |
| width | å›¾ç‰‡æ¸²æŸ“å®½åº¦ã€‚ |
| height | å›¾ç‰‡æ¸²æŸ“é«˜åº¦ã€‚ |

3. åˆ†ç»„èŠ‚ç‚¹ (type: 'group')

| å±æ€§ | è¯´æ˜ |
|------|------|
| layout | æ’åˆ—æ–¹å‘ï¼š`row`ï¼ˆæ°´å¹³ï¼‰æˆ– `column`ï¼ˆå‚ç›´ï¼‰ã€‚ |
| items | å­èŠ‚ç‚¹æ•°ç»„ `Array<Node>`ã€‚ |
| gap | ç»„å†…å…ƒç´ é—´è·ï¼ˆå­å…ƒç´ ä¼šè‡ªåŠ¨ç»§æ‰¿è¯¥é—´è·ï¼‰ã€‚ |

## âš ï¸ æ³¨æ„äº‹é¡¹
1. SSR å…¼å®¹æ€§ï¼šåœ¨ Next.js / Nuxt.js ä¸­ä½¿ç”¨æ—¶ï¼Œè¯·ç¡®ä¿åœ¨ onMounted æˆ– useEffect ä¸­è°ƒç”¨ï¼Œé¿å…æœåŠ¡ç«¯æ‰§è¡Œ document æŠ¥é”™ã€‚
2. å®šä½è¦æ±‚ï¼šå¦‚æœæŒ‡å®š el ä¸ºæŸä¸ªå±€éƒ¨å®¹å™¨ï¼Œè¯·ç¡®ä¿è¯¥å®¹å™¨è®¾ç½®äº† position: relative (ç»„ä»¶ä¼šè‡ªåŠ¨å°è¯•è®¾ç½®ï¼Œä½†å»ºè®®æ˜¾å¼å£°æ˜)ã€‚
3. å®‰å…¨è¯´æ˜ï¼šå‰ç«¯æ°´å°ä¸»è¦èµ·è­¦ç¤ºä½œç”¨ï¼Œæ— æ³•å®Œå…¨é˜²æ­¢æŠ€æœ¯æ‰‹æ®µç§»é™¤ã€‚